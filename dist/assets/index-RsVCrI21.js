var T=Object.defineProperty;var P=(d,t,e)=>t in d?T(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e;var r=(d,t,e)=>P(d,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();const l=960,h=540,c={WIDTH:32,HEIGHT:48,SPEED:300,GRAVITY:1200,MAX_FALL_SPEED:800,BOUNCE_MULTIPLIER:1.5,ICE_FRICTION:.98,NORMAL_FRICTION:.85,AIR_CONTROL:.6,COYOTE_TIME:100,JUMP_BUFFER:150},u={CRUMBLE_DELAY:500,CRUMBLE_DURATION:300,PHASE_ON_TIME:2e3,PHASE_OFF_TIME:1500},p={PLAYER:"#00ffaa",PLATFORM:{solid:"#4a5568",bounce:"#f6ad55",crumble:"#fc8181",moving:"#63b3ed",ice:"#90cdf4",lava:"#f56565",phase:"#b794f4"},LEVEL2:{grid:"#ff0080"},GOAL:"#ffd700",UI_TEXT:"#ffffff",UI_SHADOW:"#000000"},m={PARTICLE_COUNT:50,STAR_COUNT:100,WAVE_AMPLITUDE:20,WAVE_FREQUENCY:.02,PULSE_SPEED:.002,AURORA_BANDS:5};class C{constructor(){r(this,"state",{left:!1,right:!1,jump:!1,jumpPressed:!1});r(this,"previousJump",!1);this.setupListeners()}setupListeners(){window.addEventListener("keydown",t=>this.handleKeyDown(t)),window.addEventListener("keyup",t=>this.handleKeyUp(t)),window.addEventListener("blur",()=>this.resetAll())}handleKeyDown(t){switch(t.code){case"ArrowLeft":case"KeyA":this.state.left=!0;break;case"ArrowRight":case"KeyD":this.state.right=!0;break;case"ArrowUp":case"KeyW":case"Space":this.state.jump=!0;break}}handleKeyUp(t){switch(t.code){case"ArrowLeft":case"KeyA":this.state.left=!1;break;case"ArrowRight":case"KeyD":this.state.right=!1;break;case"ArrowUp":case"KeyW":case"Space":this.state.jump=!1;break}}resetAll(){this.state.left=!1,this.state.right=!1,this.state.jump=!1,this.state.jumpPressed=!1}update(){return this.state.jumpPressed=this.state.jump&&!this.previousJump,this.previousJump=this.state.jump,{...this.state}}getState(){return{...this.state}}}class E{constructor(t){r(this,"x");r(this,"y");r(this,"width",c.WIDTH);r(this,"height",c.HEIGHT);r(this,"velocityX",0);r(this,"velocityY",0);r(this,"isGrounded",!1);r(this,"isOnIce",!1);r(this,"isDead",!1);r(this,"coyoteTime",0);r(this,"jumpBufferTime",0);r(this,"trail",[]);r(this,"animationTime",0);r(this,"facingRight",!0);this.x=t.x,this.y=t.y}reset(t){this.x=t.x,this.y=t.y,this.velocityX=0,this.velocityY=0,this.isGrounded=!1,this.isDead=!1,this.coyoteTime=0,this.jumpBufferTime=0,this.trail=[]}update(t,e,s){this.isDead||(this.animationTime+=t,this.updateTrail(t),this.handleMovement(e,t),this.handleJumping(e,t),this.velocityY+=c.GRAVITY*(t/1e3),this.velocityY=Math.min(this.velocityY,c.MAX_FALL_SPEED),this.x+=this.velocityX*(t/1e3),this.y+=this.velocityY*(t/1e3),this.handleCollisions(s),this.isGrounded||(this.coyoteTime-=t),this.y>h+100&&(this.isDead=!0))}handleMovement(t,e){const s=(t.right?1:0)-(t.left?1:0),i=this.isGrounded?c.SPEED:c.SPEED*c.AIR_CONTROL;if(s!==0)this.facingRight=s>0,this.velocityX+=s*i*(e/1e3)*10,this.velocityX=Math.max(-300,Math.min(c.SPEED,this.velocityX));else{const a=this.isOnIce?c.ICE_FRICTION:c.NORMAL_FRICTION;this.velocityX*=Math.pow(a,e/16),Math.abs(this.velocityX)<5&&(this.velocityX=0)}}handleJumping(t,e){t.jumpPressed?this.jumpBufferTime=c.JUMP_BUFFER:this.jumpBufferTime-=e;const s=this.isGrounded||this.coyoteTime>0;this.jumpBufferTime>0&&s&&(this.velocityY=-520,this.isGrounded=!1,this.coyoteTime=0,this.jumpBufferTime=0),!t.jump&&this.velocityY<-520/2&&(this.velocityY=-520/2)}handleCollisions(t){const e=this.isGrounded;this.isGrounded=!1,this.isOnIce=!1;for(const s of t){if(!s.isCollidable())continue;const i=this.checkCollision(s);if(i){switch(s.type){case"lava":this.isDead=!0;return;case"bounce":i==="top"&&(this.velocityY=-520*c.BOUNCE_MULTIPLIER,this.y=s.y-this.height);continue;case"crumble":i==="top"&&s.startCrumble();break;case"ice":i==="top"&&(this.isOnIce=!0);break}this.resolveCollision(s,i)}}e&&!this.isGrounded&&(this.coyoteTime=c.COYOTE_TIME)}checkCollision(t){const e=t.getBounds();if(this.x+this.width<=e.x||this.x>=e.x+e.width||this.y+this.height<=e.y||this.y>=e.y+e.height)return null;const s=this.x+this.width-e.x,i=e.x+e.width-this.x,a=this.y+this.height-e.y,o=e.y+e.height-this.y,n=Math.min(s,i);return Math.min(a,o)<n?a<o?"top":"bottom":s<i?"left":"right"}resolveCollision(t,e){const s=t.getBounds();switch(e){case"top":this.y=s.y-this.height,this.velocityY=0,this.isGrounded=!0;break;case"bottom":this.y=s.y+s.height,this.velocityY=0;break;case"left":this.x=s.x-this.width,this.velocityX=0;break;case"right":this.x=s.x+s.width,this.velocityX=0;break}}updateTrail(t){(Math.abs(this.velocityX)>50||Math.abs(this.velocityY)>50)&&this.trail.push({x:this.x+this.width/2,y:this.y+this.height/2,alpha:.5});for(let e=this.trail.length-1;e>=0;e--)this.trail[e].alpha-=t/200,this.trail[e].alpha<=0&&this.trail.splice(e,1);for(;this.trail.length>20;)this.trail.shift()}getBounds(){return{x:this.x,y:this.y,width:this.width,height:this.height}}render(t){for(const o of this.trail)t.fillStyle=`rgba(0, 255, 170, ${o.alpha})`,t.beginPath(),t.arc(o.x,o.y,8*o.alpha,0,Math.PI*2),t.fill();t.save(),t.translate(this.x+this.width/2,this.y+this.height/2);const e=1+Math.abs(this.velocityY)/2e3,s=1/e;t.scale(s,e),this.facingRight||t.scale(-1,1),t.shadowColor=p.PLAYER,t.shadowBlur=15;const i=t.createLinearGradient(-this.width/2,-this.height/2,this.width/2,this.height/2);i.addColorStop(0,"#00ffcc"),i.addColorStop(.5,p.PLAYER),i.addColorStop(1,"#00cc88"),t.fillStyle=i,this.drawRoundedRect(t,-this.width/2,-this.height/2,this.width,this.height,8),t.fillStyle="#ffffff",t.beginPath(),t.ellipse(5,-10,6,8,0,0,Math.PI*2),t.fill(),t.fillStyle="#000000",t.beginPath(),t.arc(7,-10,3,0,Math.PI*2),t.fill();const a=Math.sin(this.animationTime*.005)*.1+.9;t.strokeStyle=`rgba(0, 255, 170, ${.5*a})`,t.lineWidth=2,this.strokeRoundedRect(t,-this.width/2-3,-this.height/2-3,this.width+6,this.height+6,10),t.restore()}drawRoundedRect(t,e,s,i,a,o){t.beginPath(),t.moveTo(e+o,s),t.lineTo(e+i-o,s),t.quadraticCurveTo(e+i,s,e+i,s+o),t.lineTo(e+i,s+a-o),t.quadraticCurveTo(e+i,s+a,e+i-o,s+a),t.lineTo(e+o,s+a),t.quadraticCurveTo(e,s+a,e,s+a-o),t.lineTo(e,s+o),t.quadraticCurveTo(e,s,e+o,s),t.closePath(),t.fill()}strokeRoundedRect(t,e,s,i,a,o){t.beginPath(),t.moveTo(e+o,s),t.lineTo(e+i-o,s),t.quadraticCurveTo(e+i,s,e+i,s+o),t.lineTo(e+i,s+a-o),t.quadraticCurveTo(e+i,s+a,e+i-o,s+a),t.lineTo(e+o,s+a),t.quadraticCurveTo(e,s+a,e,s+a-o),t.lineTo(e,s+o),t.quadraticCurveTo(e,s,e+o,s),t.closePath(),t.stroke()}}class M{constructor(t){r(this,"x");r(this,"y");r(this,"width");r(this,"height");r(this,"type");r(this,"movePattern");r(this,"color");r(this,"startX");r(this,"startY");r(this,"moveTime",0);r(this,"crumbleTimer",0);r(this,"isCrumbling",!1);r(this,"crumbleProgress",0);r(this,"phaseTimer",0);r(this,"isPhased",!1);r(this,"isDestroyed",!1);var e;this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.type=t.type,this.movePattern=t.movePattern,this.color=t.color||p.PLATFORM[t.type],this.startX=t.x,this.startY=t.y,(e=t.movePattern)!=null&&e.startOffset&&(this.moveTime=t.movePattern.startOffset)}update(t){if(!this.isDestroyed&&(this.movePattern&&this.type==="moving"&&this.updateMovement(t),this.type==="crumble"&&this.isCrumbling&&(this.crumbleTimer+=t,this.crumbleTimer>=u.CRUMBLE_DELAY&&(this.crumbleProgress=Math.min(1,(this.crumbleTimer-u.CRUMBLE_DELAY)/u.CRUMBLE_DURATION),this.crumbleProgress>=1&&(this.isDestroyed=!0))),this.type==="phase")){this.phaseTimer+=t;const e=u.PHASE_ON_TIME+u.PHASE_OFF_TIME,s=this.phaseTimer%e;this.isPhased=s>u.PHASE_ON_TIME}}updateMovement(t){if(this.movePattern)switch(this.moveTime+=t*.001*this.movePattern.speed,this.movePattern.type){case"horizontal":this.x=this.startX+Math.sin(this.moveTime)*this.movePattern.distance;break;case"vertical":this.y=this.startY+Math.sin(this.moveTime)*this.movePattern.distance;break;case"circular":this.x=this.startX+Math.cos(this.moveTime)*this.movePattern.distance,this.y=this.startY+Math.sin(this.moveTime)*this.movePattern.distance;break}}startCrumble(){this.type==="crumble"&&!this.isCrumbling&&(this.isCrumbling=!0)}getBounds(){return{x:this.x,y:this.y,width:this.width,height:this.height}}isCollidable(){return!this.isDestroyed&&!this.isPhased}render(t){if(!this.isDestroyed){if(t.save(),this.type==="phase"){const e=this.isPhased?.2:1;t.globalAlpha=e}if(this.isCrumbling&&this.crumbleProgress<1){const e=(1-this.crumbleProgress)*3;t.translate((Math.random()-.5)*e,(Math.random()-.5)*e),t.globalAlpha=1-this.crumbleProgress}this.drawPlatform(t),t.restore()}}drawPlatform(t){const e=t.createLinearGradient(this.x,this.y,this.x,this.y+this.height);switch(this.type){case"bounce":e.addColorStop(0,"#ffc107"),e.addColorStop(1,"#ff9800"),t.fillStyle=e,t.fillRect(this.x,this.y,this.width,this.height),t.strokeStyle="#fff",t.lineWidth=2;for(let o=0;o<3;o++){const n=this.x+this.width/4*(o+1);t.beginPath(),t.moveTo(n-5,this.y+this.height/2),t.lineTo(n,this.y+5),t.lineTo(n+5,this.y+this.height/2),t.stroke()}break;case"ice":e.addColorStop(0,"rgba(200, 240, 255, 0.9)"),e.addColorStop(1,"rgba(150, 200, 255, 0.8)"),t.fillStyle=e,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle="rgba(255, 255, 255, 0.5)",t.fillRect(this.x+5,this.y+3,this.width*.3,4);break;case"lava":e.addColorStop(0,"#ff4444"),e.addColorStop(.5,"#ff6600"),e.addColorStop(1,"#ff2200"),t.fillStyle=e,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle="rgba(255, 200, 0, 0.7)";const s=Date.now()*.003;for(let o=0;o<3;o++){const n=this.x+this.width/4*(o+1),f=this.y+5+Math.sin(s+o)*3;t.beginPath(),t.arc(n,f,4,0,Math.PI*2),t.fill()}break;case"crumble":e.addColorStop(0,"#a0522d"),e.addColorStop(1,"#8b4513"),t.fillStyle=e,t.fillRect(this.x,this.y,this.width,this.height),t.strokeStyle="#654321",t.lineWidth=1,t.beginPath(),t.moveTo(this.x+this.width*.3,this.y),t.lineTo(this.x+this.width*.4,this.y+this.height),t.moveTo(this.x+this.width*.7,this.y),t.lineTo(this.x+this.width*.6,this.y+this.height),t.stroke();break;case"moving":e.addColorStop(0,"#4fc3f7"),e.addColorStop(1,"#0288d1"),t.fillStyle=e,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle="rgba(255, 255, 255, 0.5)",t.beginPath(),t.moveTo(this.x+10,this.y+this.height/2),t.lineTo(this.x+20,this.y+this.height/2-5),t.lineTo(this.x+20,this.y+this.height/2+5),t.fill(),t.beginPath(),t.moveTo(this.x+this.width-10,this.y+this.height/2),t.lineTo(this.x+this.width-20,this.y+this.height/2-5),t.lineTo(this.x+this.width-20,this.y+this.height/2+5),t.fill();break;case"phase":const i=t.createLinearGradient(this.x,this.y,this.x+this.width,this.y);i.addColorStop(0,"#9c27b0"),i.addColorStop(.5,"#e040fb"),i.addColorStop(1,"#9c27b0"),t.fillStyle=i,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle="rgba(255, 255, 255, 0.6)";const a=Date.now()*.005;for(let o=0;o<5;o++){const n=this.x+this.width/6*(o+1),f=this.y+this.height/2+Math.sin(a+o)*5;t.beginPath(),t.arc(n,f,2,0,Math.PI*2),t.fill()}break;default:e.addColorStop(0,"#5a6a7a"),e.addColorStop(1,"#3a4a5a"),t.fillStyle=e,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle="rgba(255, 255, 255, 0.2)",t.fillRect(this.x,this.y,this.width,3);break}t.strokeStyle="rgba(0, 0, 0, 0.3)",t.lineWidth=2,t.strokeRect(this.x,this.y,this.width,this.height)}}class L{constructor(t){r(this,"config");r(this,"time",0);r(this,"stars",[]);r(this,"particles",[]);r(this,"gridLines",[]);r(this,"wavePoints",[]);r(this,"auroraBands",[]);r(this,"sunY",h*.65);r(this,"mountainPoints",[]);this.config=t,this.initializeEffects()}initializeEffects(){const t=this.config.effects||[];t.includes("stars")&&this.initializeStars(),this.config.particles&&this.initializeParticles(),t.includes("grid")&&this.initializeGrid(),t.includes("waves")&&this.initializeWaves(),t.includes("aurora")&&this.initializeAurora(),this.config.type==="neon"&&this.initializeMountains()}initializeStars(){for(let t=0;t<m.STAR_COUNT;t++)this.stars.push({x:Math.random()*l,y:Math.random()*h*.6,size:Math.random()*2+.5,brightness:Math.random(),twinkleSpeed:Math.random()*.003+.001})}initializeParticles(){var e,s,i,a,o;const t=((e=this.config.particles)==null?void 0:e.count)||m.PARTICLE_COUNT;for(let n=0;n<t;n++)this.particles.push({x:Math.random()*l,y:Math.random()*h,size:Math.random()*((((s=this.config.particles)==null?void 0:s.maxSize)||4)-(((i=this.config.particles)==null?void 0:i.minSize)||1))+(((a=this.config.particles)==null?void 0:a.minSize)||1),speed:Math.random()*(((o=this.config.particles)==null?void 0:o.speed)||50)+20,opacity:Math.random()*.5+.3})}initializeGrid(){for(let t=0;t<20;t++)this.gridLines.push({y:h*.5+t*30,speed:50+t*10})}initializeWaves(){for(let t=0;t<5;t++)this.wavePoints.push({x:0,amplitude:m.WAVE_AMPLITUDE*(1-t*.15),frequency:m.WAVE_FREQUENCY*(1+t*.3),phase:t*.5})}initializeAurora(){for(let t=0;t<m.AURORA_BANDS;t++)this.auroraBands.push({y:h*.1+t*40,height:60+Math.random()*40,hue:120+t*30,speed:5e-4+Math.random()*.001,offset:Math.random()*Math.PI*2})}initializeMountains(){for(let t=0;t<3;t++){const e=[];for(let i=0;i<=12;i++){const a=l/12*i,o=h*(.4+t*.1),n=Math.sin(i*.8+t)*50+Math.random()*30;e.push(a,o+n)}this.mountainPoints.push(e)}}update(t){this.time+=t,this.updateParticles(t),this.updateGrid(t)}updateParticles(t){var s;const e=((s=this.config.particles)==null?void 0:s.direction)||"up";for(const i of this.particles)switch(e){case"up":i.y-=i.speed*(t/1e3),i.y<-10&&(i.y=h+10,i.x=Math.random()*l);break;case"down":i.y+=i.speed*(t/1e3),i.y>h+10&&(i.y=-10,i.x=Math.random()*l);break;case"random":i.x+=(Math.random()-.5)*i.speed*(t/1e3),i.y+=(Math.random()-.5)*i.speed*(t/1e3),i.x<0&&(i.x=l),i.x>l&&(i.x=0),i.y<0&&(i.y=h),i.y>h&&(i.y=0);break}}updateGrid(t){for(const e of this.gridLines)e.y+=e.speed*(t/1e3),e.y>h+50&&(e.y=h*.5)}render(t){switch(this.drawBaseGradient(t),this.config.type){case"city":this.drawCityBackground(t);break;case"neon":this.drawNeonBackground(t);break;case"space":this.drawSpaceBackground(t);break;case"forest":this.drawForestBackground(t);break}this.renderEffects(t)}drawBaseGradient(t){const e=t.createLinearGradient(0,0,0,h);e.addColorStop(0,this.config.primaryColor),e.addColorStop(.5,this.config.secondaryColor),e.addColorStop(1,this.config.primaryColor),t.fillStyle=e,t.fillRect(0,0,l,h)}drawCityBackground(t){t.fillStyle="rgba(20, 30, 50, 0.8)";for(let a=0;a<15;a++){const o=a*70-20,n=50+Math.random()*30,f=100+Math.sin(a*.7)*80;t.fillRect(o,h-f,n,f),t.fillStyle="rgba(255, 220, 100, 0.3)";for(let y=h-f+15;y<h-20;y+=20)for(let g=o+8;g<o+n-8;g+=15)Math.random()>.3&&t.fillRect(g,y,6,10);t.fillStyle="rgba(20, 30, 50, 0.8)"}const e=l*.8,s=h*.15,i=t.createRadialGradient(e,s,0,e,s,80);i.addColorStop(0,"rgba(255, 255, 240, 0.3)"),i.addColorStop(1,"rgba(255, 255, 240, 0)"),t.fillStyle=i,t.beginPath(),t.arc(e,s,80,0,Math.PI*2),t.fill(),t.fillStyle="#f0f0e0",t.beginPath(),t.arc(e,s,30,0,Math.PI*2),t.fill()}drawNeonBackground(t){const e=l/2,s=120,i=t.createRadialGradient(e,this.sunY,0,e,this.sunY,s*2);i.addColorStop(0,"rgba(255, 100, 50, 0.5)"),i.addColorStop(.5,"rgba(255, 50, 100, 0.2)"),i.addColorStop(1,"rgba(255, 0, 150, 0)"),t.fillStyle=i,t.beginPath(),t.arc(e,this.sunY,s*2,0,Math.PI*2),t.fill(),t.save(),t.beginPath(),t.arc(e,this.sunY,s,0,Math.PI*2),t.clip();const a=t.createLinearGradient(e,this.sunY-s,e,this.sunY+s);a.addColorStop(0,"#ff6b35"),a.addColorStop(.5,"#ff0066"),a.addColorStop(1,"#9933ff"),t.fillStyle=a,t.fillRect(e-s,this.sunY-s,s*2,s*2),t.fillStyle=this.config.primaryColor;for(let o=0;o<8;o++){const n=this.sunY+o*20-20,f=4+o*2;t.fillRect(e-s,n,s*2,f)}t.restore(),this.drawNeonMountains(t),this.drawPerspectiveGrid(t)}drawNeonMountains(t){const e=["#1a0533","#2d0a4e","#400f6b"];for(let s=0;s<this.mountainPoints.length;s++){const i=this.mountainPoints[s];t.beginPath(),t.moveTo(0,h);for(let a=0;a<i.length;a+=2)t.lineTo(i[a],i[a+1]);t.lineTo(l,h),t.closePath(),t.fillStyle=e[s]||e[0],t.fill(),t.strokeStyle=`rgba(255, 0, 255, ${.3-s*.1})`,t.lineWidth=2,t.beginPath();for(let a=0;a<i.length;a+=2)a===0?t.moveTo(i[a],i[a+1]):t.lineTo(i[a],i[a+1]);t.stroke()}}drawPerspectiveGrid(t){const e=h*.55,s=l/2;t.strokeStyle=p.LEVEL2.grid,t.lineWidth=1,t.globalAlpha=.4;for(const a of this.gridLines)if(a.y>e){const n=(a.y-e)/(h-e)*.6;t.globalAlpha=n,t.beginPath(),t.moveTo(0,a.y),t.lineTo(l,a.y),t.stroke()}t.globalAlpha=.3;const i=20;for(let a=0;a<=i;a++){const o=l/i*a;t.beginPath(),t.moveTo(s,e),t.lineTo(o,h),t.stroke()}t.globalAlpha=1}drawSpaceBackground(t){for(let e=0;e<3;e++){const s=t.createRadialGradient(l*(.2+e*.3),h*(.3+Math.sin(e)*.2),0,l*(.2+e*.3),h*(.3+Math.sin(e)*.2),200);s.addColorStop(0,`rgba(${100+e*50}, 50, ${200-e*30}, 0.2)`),s.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=s,t.fillRect(0,0,l,h)}}drawForestBackground(t){for(let e=0;e<3;e++){const s=h*(.4+e*.15),i=t.createLinearGradient(0,s-50,0,s+50);i.addColorStop(0,"rgba(100, 200, 150, 0)"),i.addColorStop(.5,`rgba(100, 200, 150, ${.1-e*.02})`),i.addColorStop(1,"rgba(100, 200, 150, 0)"),t.fillStyle=i,t.fillRect(0,s-50,l,100)}t.fillStyle="rgba(10, 30, 20, 0.6)";for(let e=0;e<8;e++){const s=e*130+50,i=200+Math.sin(e*1.5)*80;this.drawTree(t,s,h,i)}}drawTree(t,e,s,i){t.beginPath(),t.moveTo(e,s),t.lineTo(e-i*.3,s-i*.6),t.lineTo(e-i*.15,s-i*.6),t.lineTo(e-i*.25,s-i*.8),t.lineTo(e-i*.1,s-i*.8),t.lineTo(e,s-i),t.lineTo(e+i*.1,s-i*.8),t.lineTo(e+i*.25,s-i*.8),t.lineTo(e+i*.15,s-i*.6),t.lineTo(e+i*.3,s-i*.6),t.closePath(),t.fill()}renderEffects(t){const e=this.config.effects||[];e.includes("stars")&&this.renderStars(t),this.config.particles&&this.renderParticles(t),e.includes("aurora")&&this.renderAurora(t),e.includes("scanlines")&&this.renderScanlines(t),e.includes("pulse")&&this.renderPulse(t)}renderStars(t){for(const e of this.stars){const s=Math.sin(this.time*e.twinkleSpeed)*.5+.5,i=e.brightness*s;t.fillStyle=`rgba(255, 255, 255, ${i})`,t.beginPath(),t.arc(e.x,e.y,e.size,0,Math.PI*2),t.fill(),e.size>1.5&&(t.fillStyle=`rgba(255, 255, 255, ${i*.3})`,t.beginPath(),t.arc(e.x,e.y,e.size*2,0,Math.PI*2),t.fill())}}renderParticles(t){var s;const e=((s=this.config.particles)==null?void 0:s.color)||"#ffffff";for(const i of this.particles)t.fillStyle=e.replace(")",`, ${i.opacity})`).replace("rgb","rgba"),t.beginPath(),t.arc(i.x,i.y,i.size,0,Math.PI*2),t.fill()}renderAurora(t){for(const e of this.auroraBands){const s=Math.sin(this.time*e.speed+e.offset),i=e.y+s*20,a=t.createLinearGradient(0,i,0,i+e.height);a.addColorStop(0,`hsla(${e.hue}, 80%, 50%, 0)`),a.addColorStop(.5,`hsla(${e.hue}, 80%, 50%, 0.15)`),a.addColorStop(1,`hsla(${e.hue}, 80%, 50%, 0)`),t.fillStyle=a,t.beginPath(),t.moveTo(0,i);for(let o=0;o<=l;o+=20){const n=i+Math.sin(o*.01+this.time*.001+e.offset)*15;t.lineTo(o,n)}t.lineTo(l,i+e.height),t.lineTo(0,i+e.height),t.closePath(),t.fill()}}renderScanlines(t){t.fillStyle="rgba(0, 0, 0, 0.1)";for(let e=0;e<h;e+=4)t.fillRect(0,e,l,2)}renderPulse(t){const e=Math.sin(this.time*m.PULSE_SPEED)*.5+.5,s=t.createRadialGradient(l/2,h/2,0,l/2,h/2,l/2);s.addColorStop(0,`rgba(${this.hexToRgb(this.config.accentColor)}, ${e*.1})`),s.addColorStop(1,"rgba(0, 0, 0, 0)"),t.fillStyle=s,t.fillRect(0,0,l,h)}hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?`${parseInt(e[1],16)}, ${parseInt(e[2],16)}, ${parseInt(e[3],16)}`:"255, 255, 255"}}class b{constructor(t){r(this,"id");r(this,"name");r(this,"platforms",[]);r(this,"goal");r(this,"playerStart");r(this,"background");this.id=t.id,this.name=t.name,this.goal=t.goal,this.playerStart=t.playerStart,this.background=new L(t.background);for(const e of t.platforms)this.platforms.push(new M(e))}reset(){this.platforms=[]}update(t){this.background.update(t);for(const e of this.platforms)e.update(t)}checkGoal(t){const e=t.getBounds();return e.x<this.goal.x+this.goal.width&&e.x+e.width>this.goal.x&&e.y<this.goal.y+this.goal.height&&e.y+e.height>this.goal.y}render(t){this.background.render(t);for(const e of this.platforms)e.render(t);this.renderGoal(t)}renderGoal(t){const e=Date.now()*.003,s=Math.sin(e)*.3+.7;t.shadowColor=p.GOAL,t.shadowBlur=20*s;const i=t.createLinearGradient(this.goal.x,this.goal.y,this.goal.x,this.goal.y+this.goal.height);i.addColorStop(0,"#ffd700"),i.addColorStop(.5,"#ffed4a"),i.addColorStop(1,"#ffd700"),t.fillStyle=i,t.fillRect(this.goal.x,this.goal.y,this.goal.width,this.goal.height),t.fillStyle="#fff";const a=this.goal.x+this.goal.width/2,o=this.goal.y+this.goal.height/2;this.drawStar(t,a,o,12*s,5),t.shadowBlur=0}drawStar(t,e,s,i,a){t.beginPath();for(let o=0;o<a*2;o++){const n=o%2===0?i:i/2,f=Math.PI/a*o-Math.PI/2,y=e+Math.cos(f)*n,g=s+Math.sin(f)*n;o===0?t.moveTo(y,g):t.lineTo(y,g)}t.closePath(),t.fill()}getActivePlatforms(){return this.platforms.filter(t=>t.isCollidable())}}const A={id:1,name:"City Nights",playerStart:{x:50,y:h-150},goal:{x:l-80,y:100,width:50,height:60},background:{type:"city",primaryColor:"#0a0a1a",secondaryColor:"#151530",accentColor:"#e94560",particles:{count:30,color:"rgba(255, 255, 255",minSize:1,maxSize:3,speed:30,direction:"down"},effects:["stars"]},platforms:[{x:0,y:h-40,width:200,height:40,type:"solid"},{x:250,y:h-40,width:150,height:40,type:"solid"},{x:450,y:h-40,width:200,height:40,type:"solid"},{x:100,y:h-120,width:120,height:20,type:"solid"},{x:280,y:h-140,width:100,height:20,type:"solid"},{x:440,y:h-160,width:100,height:20,type:"solid"},{x:50,y:h-240,width:80,height:20,type:"solid"},{x:180,y:h-260,width:80,height:20,type:"bounce"},{x:320,y:h-280,width:100,height:20,type:"solid"},{x:480,y:h-240,width:120,height:20,type:"solid"},{x:100,y:h-360,width:100,height:20,type:"moving",movePattern:{type:"horizontal",distance:80,speed:1.5}},{x:280,y:h-380,width:80,height:20,type:"solid"},{x:420,y:h-360,width:100,height:20,type:"solid"},{x:550,y:h-300,width:80,height:20,type:"solid"},{x:680,y:h-250,width:100,height:20,type:"solid"},{x:820,y:h-200,width:80,height:20,type:"solid"},{x:700,y:h-350,width:80,height:20,type:"solid"},{x:580,y:h-420,width:100,height:20,type:"solid"},{x:720,y:h-440,width:100,height:20,type:"solid"},{x:860,y:h-380,width:100,height:20,type:"solid"},{x:l-150,y:180,width:120,height:20,type:"solid"}]};class w extends b{constructor(){super(A)}}const R={id:2,name:"Neon Dreams",playerStart:{x:50,y:h-150},goal:{x:l-80,y:80,width:50,height:60},background:{type:"neon",primaryColor:"#0d0221",secondaryColor:"#1a0533",accentColor:"#ff00ff",particles:{count:40,color:"rgba(255, 0, 255",minSize:1,maxSize:4,speed:40,direction:"up"},effects:["grid","scanlines","pulse"]},platforms:[{x:0,y:h-40,width:180,height:40,type:"solid"},{x:200,y:h-60,width:100,height:20,type:"ice"},{x:340,y:h-80,width:80,height:20,type:"solid"},{x:460,y:h-60,width:120,height:20,type:"solid"},{x:200,y:h-20,width:400,height:20,type:"lava"},{x:100,y:h-160,width:80,height:20,type:"solid"},{x:220,y:h-180,width:70,height:20,type:"crumble"},{x:330,y:h-200,width:70,height:20,type:"crumble"},{x:440,y:h-180,width:80,height:20,type:"solid"},{x:50,y:h-280,width:100,height:20,type:"phase"},{x:200,y:h-300,width:80,height:20,type:"solid"},{x:320,y:h-320,width:100,height:20,type:"phase"},{x:470,y:h-280,width:80,height:20,type:"solid"},{x:80,y:h-380,width:80,height:20,type:"moving",movePattern:{type:"horizontal",distance:100,speed:2}},{x:280,y:h-400,width:80,height:20,type:"moving",movePattern:{type:"vertical",distance:50,speed:1.5}},{x:450,y:h-380,width:80,height:20,type:"moving",movePattern:{type:"horizontal",distance:80,speed:2.5,startOffset:1.5}},{x:580,y:h-100,width:100,height:20,type:"solid"},{x:700,y:h-160,width:80,height:20,type:"bounce"},{x:600,y:h-250,width:90,height:20,type:"solid"},{x:720,y:h-320,width:80,height:20,type:"ice"},{x:620,y:h-400,width:100,height:20,type:"solid"},{x:750,y:h-450,width:70,height:20,type:"moving",movePattern:{type:"circular",distance:40,speed:1.8}},{x:500,y:h-460,width:80,height:20,type:"solid"},{x:350,y:h-440,width:70,height:20,type:"crumble"},{x:200,y:h-460,width:100,height:20,type:"phase"},{x:50,y:h-440,width:80,height:20,type:"solid"},{x:100,y:h-500,width:150,height:15,type:"ice"},{x:300,y:h-480,width:100,height:15,type:"ice"},{x:450,y:h-500,width:60,height:20,type:"bounce"},{x:560,y:h-480,width:60,height:20,type:"solid"},{x:680,y:h-500,width:60,height:20,type:"bounce"},{x:780,y:h-420,width:80,height:20,type:"solid"},{x:800,y:h-340,width:100,height:15,type:"lava"},{x:820,y:h-380,width:70,height:20,type:"moving",movePattern:{type:"horizontal",distance:30,speed:3}},{x:l-120,y:160,width:100,height:20,type:"solid"},{x:850,y:h-460,width:80,height:20,type:"phase"},{x:l-100,y:h-380,width:70,height:20,type:"solid"},{x:l-80,y:h-280,width:60,height:20,type:"solid"},{x:l-100,y:h-180,width:80,height:20,type:"bounce"}]};class I extends b{constructor(){super(R)}}function k(d){switch(d){case 1:return new w;case 2:return new I;default:return new w}}const S=2;class O{constructor(t){r(this,"canvas");r(this,"ctx");r(this,"input");r(this,"state",{currentLevel:1,lives:3,score:0,gameStatus:"menu"});r(this,"player");r(this,"level");r(this,"lastTime",0);r(this,"deathTimer",0);r(this,"gameLoop",()=>{const t=performance.now(),e=Math.min(t-this.lastTime,50);this.lastTime=t,this.update(e),this.render(),requestAnimationFrame(this.gameLoop)});this.canvas=t,this.canvas.width=l,this.canvas.height=h;const e=t.getContext("2d");if(!e)throw new Error("Could not get 2D context");this.ctx=e,this.input=new C,this.loadLevel(1),window.addEventListener("keydown",s=>this.handleMenuInput(s))}loadLevel(t){this.level=k(t),this.player=new E(this.level.playerStart),this.state.currentLevel=t}handleMenuInput(t){this.state.gameStatus==="menu"?t.code==="Enter"||t.code==="Space"?this.startGame():t.code==="Digit1"?(this.state.currentLevel=1,this.startGame()):t.code==="Digit2"&&(this.state.currentLevel=2,this.startGame()):this.state.gameStatus==="gameOver"?(t.code==="Enter"||t.code==="Space")&&this.resetGame():this.state.gameStatus==="levelComplete"?(t.code==="Enter"||t.code==="Space")&&this.nextLevel():this.state.gameStatus==="playing"?t.code==="Escape"&&(this.state.gameStatus="paused"):this.state.gameStatus==="paused"&&(t.code==="Escape"||t.code==="Enter")&&(this.state.gameStatus="playing")}startGame(){this.loadLevel(this.state.currentLevel),this.state.lives=3,this.state.score=0,this.state.gameStatus="playing"}resetGame(){this.state.currentLevel=1,this.startGame()}nextLevel(){this.state.currentLevel<S?(this.state.currentLevel++,this.loadLevel(this.state.currentLevel),this.state.gameStatus="playing"):this.state.gameStatus="menu"}respawnPlayer(){this.state.lives--,this.state.lives<=0?this.state.gameStatus="gameOver":this.loadLevel(this.state.currentLevel)}start(){this.lastTime=performance.now(),this.gameLoop()}update(t){if(this.state.gameStatus!=="playing"){this.level.update(t);return}const e=this.input.update();if(this.level.update(t),this.player.update(t,e,this.level.getActivePlatforms()),this.player.isDead){this.deathTimer+=t,this.deathTimer>1e3&&(this.deathTimer=0,this.respawnPlayer());return}this.level.checkGoal(this.player)&&(this.state.score+=1e3,this.state.gameStatus="levelComplete"),this.player.x<0&&(this.player.x=0),this.player.x>l-this.player.width&&(this.player.x=l-this.player.width)}render(){switch(this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,l,h),this.level.render(this.ctx),(this.state.gameStatus==="playing"||this.state.gameStatus==="paused")&&this.player.render(this.ctx),this.renderUI(),this.state.gameStatus){case"menu":this.renderMenu();break;case"paused":this.renderPaused();break;case"gameOver":this.renderGameOver();break;case"levelComplete":this.renderLevelComplete();break}}renderUI(){this.state.gameStatus!=="playing"&&this.state.gameStatus!=="paused"||(this.ctx.save(),this.ctx.font='bold 20px "Segoe UI", sans-serif',this.ctx.textAlign="left",this.ctx.fillStyle=p.UI_TEXT,this.ctx.shadowColor=p.UI_SHADOW,this.ctx.shadowBlur=4,this.ctx.fillText(`Level ${this.state.currentLevel}: ${this.level.name}`,20,35),this.ctx.fillText(`Lives: ${"â™¥".repeat(this.state.lives)}`,20,65),this.ctx.textAlign="right",this.ctx.fillText(`Score: ${this.state.score}`,l-20,35),this.ctx.font='14px "Segoe UI", sans-serif',this.ctx.fillStyle="rgba(255, 255, 255, 0.5)",this.ctx.fillText("Arrow keys / WASD to move, Space to jump",l-20,65),this.ctx.restore())}renderMenu(){this.renderOverlay(),this.ctx.save(),this.ctx.textAlign="center",this.ctx.fillStyle=p.UI_TEXT,this.ctx.shadowColor="#00ffff",this.ctx.shadowBlur=20,this.ctx.font='bold 64px "Segoe UI", sans-serif',this.ctx.fillText("TEMPO DASH",l/2,h/2-80),this.ctx.font='24px "Segoe UI", sans-serif',this.ctx.shadowBlur=10,this.ctx.fillText("A Rhythm Platformer",l/2,h/2-30),this.ctx.font='20px "Segoe UI", sans-serif',this.ctx.shadowBlur=5,this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.fillText("Press ENTER or SPACE to start",l/2,h/2+40),this.ctx.fillText("Press 1 for Level 1, 2 for Level 2",l/2,h/2+75),this.ctx.font='16px "Segoe UI", sans-serif',this.ctx.fillStyle="rgba(255, 255, 255, 0.6)",this.ctx.fillText("Controls: Arrow keys or WASD to move, Space to jump",l/2,h/2+130),this.ctx.restore()}renderPaused(){this.renderOverlay(),this.ctx.save(),this.ctx.textAlign="center",this.ctx.fillStyle=p.UI_TEXT,this.ctx.shadowColor="#ff00ff",this.ctx.shadowBlur=15,this.ctx.font='bold 48px "Segoe UI", sans-serif',this.ctx.fillText("PAUSED",l/2,h/2-20),this.ctx.font='20px "Segoe UI", sans-serif',this.ctx.shadowBlur=5,this.ctx.fillText("Press ESC or ENTER to continue",l/2,h/2+30),this.ctx.restore()}renderGameOver(){this.renderOverlay(),this.ctx.save(),this.ctx.textAlign="center",this.ctx.fillStyle="#ff4444",this.ctx.shadowColor="#ff0000",this.ctx.shadowBlur=20,this.ctx.font='bold 56px "Segoe UI", sans-serif',this.ctx.fillText("GAME OVER",l/2,h/2-40),this.ctx.fillStyle=p.UI_TEXT,this.ctx.font='24px "Segoe UI", sans-serif',this.ctx.shadowBlur=10,this.ctx.fillText(`Final Score: ${this.state.score}`,l/2,h/2+20),this.ctx.font='20px "Segoe UI", sans-serif',this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.fillText("Press ENTER or SPACE to restart",l/2,h/2+70),this.ctx.restore()}renderLevelComplete(){this.renderOverlay(),this.ctx.save(),this.ctx.textAlign="center",this.ctx.fillStyle=p.GOAL,this.ctx.shadowColor="#ffd700",this.ctx.shadowBlur=25,this.ctx.font='bold 56px "Segoe UI", sans-serif',this.ctx.fillText("LEVEL COMPLETE!",l/2,h/2-40),this.ctx.fillStyle=p.UI_TEXT,this.ctx.font='24px "Segoe UI", sans-serif',this.ctx.shadowBlur=10,this.ctx.fillText(`Score: ${this.state.score}`,l/2,h/2+20),this.ctx.font='20px "Segoe UI", sans-serif',this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.state.currentLevel<S?this.ctx.fillText("Press ENTER or SPACE for next level",l/2,h/2+70):(this.ctx.fillText("Congratulations! You beat the game!",l/2,h/2+60),this.ctx.fillText("Press ENTER or SPACE to return to menu",l/2,h/2+95)),this.ctx.restore()}renderOverlay(){this.ctx.fillStyle="rgba(0, 0, 0, 0.7)",this.ctx.fillRect(0,0,l,h)}}function v(){const d=document.getElementById("game-canvas");if(!d){console.error("Canvas element not found");return}new O(d).start()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",v):v();
